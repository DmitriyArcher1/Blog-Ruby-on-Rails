<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Редактирование профиля</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
</head>
<body>

  <header class="header">
    <div class="header-top">
        <%= link_to "ФОТО БЛОГ", root_path, class: "logo" %>

        <nav class="navigation">
            <ul class="menu">
                <li class="menu-element">
                    <i style="color: #000;" class="fa-solid fa-house"></i>
                    <%= link_to "Главная", root_path %>
                </li>

                <li class="menu-element">
                    <i style="color: #000;" class="fa-solid fa-plus"></i>
                    <%= link_to "Добавить пост", "/blog_posts/new" %>
                </li>

                <li class="menu-element">
                    <% if user_signed_in? %>
                        <i style="color: #000;" class="fa-solid fa-user"></i>
                        <%= link_to "Мой профиль", user_path(current_user) %>
                    <% end %>
                </li>

                <li class="menu-element">
                    <% if user_signed_in? %>
                        <% if current_user.avatar.attached? %>
                            <img style="width: 50px; height: 50px; border-radius: 100px;" <%= image_tag url_for(current_user.avatar) %>
                        <% else %>
                            <%= image_tag "base-avatar.jpg", style: "width: 50px; height: 50px; border-radius: 100px;" %>
                        <% end %>
                    <% end %>
                </li>

                <% if !user_signed_in? %>
                    <li class="menu-element">
                        <%= link_to "Войти", new_user_session_path %>
                    </li>

                    <li class="menu-element">
                        <%= link_to "Регистрация", new_user_registration_path %>
                    </li>
                <% end %>

                
                <%= form_tag root_path, method: :get do %>
                    <%= text_field_tag :search, params[:search], placeholder: "Найти пост", class: "search_field" %>
                    <%= submit_tag "Поиск", class: "search_button" %>
                <% end %>
                </li>
            </ul>
        </nav>

        
        
    </div>
  </header>


  <h2 class="edit_profile_title">Редактирование профиля <%#= resource_name.to_s.humanize %></h2>

  <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %>
    <%= render "devise/shared/error_messages", resource: resource %>

    <div class="field">
      <%= f.label "Email" %><br />
      <%= f.email_field :email, autofocus: true, autocomplete: "email" %>
    </div>

    <div class="field">
      <%= f.label "Имя пользователя" %><br />
      <%= f.text_field :username, autofocus: true, autocomplete: "username" %>
    </div>

    <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
      <div>Currently waiting confirmation for: <%= resource.unconfirmed_email %></div>
    <% end %>

    <div class="field">
      <%= f.label "Пароль" %> <i>(оставьте поле пустым, если не хотите менять пароль)</i><br />
      <%= f.password_field :password, autocomplete: "new-password" %>
      <% if @minimum_password_length %>
        <br />
        <em>минимум <%= @minimum_password_length %> символов</em>
      <% end %>
    </div>

    <div class="field">
      <%= f.label "Подтверждение пароля" %><br />
      <%= f.password_field :password_confirmation, autocomplete: "new-password" %>
    </div>

    <div class="field">
      <%= f.label "Текущий пароль" %> <i>(нам нужен ваш текущий пароль, чтобы обновить профиль)</i><br />
      <%= f.password_field :current_password, autocomplete: "current-password" %>
    </div>

    <div class="field">
      <%= f.label "Аватар пользователя" %>
      <%= f.file_field :avatar %>
    </div>

    <div class="actions">
      <%= f.submit "Обновить" %>
    </div>
  <% end %>

  <h2 style="color: red; text-align: center;">ОПАСНАЯ ЗОНА</h2>

  <h3 style="text-align: center">Удаление аккаунта</h3>
  
  <div align="center">Не нравится профиль? <%= button_to "Удалить аккаунт", registration_path(resource_name), class: "delete_account_button", data: { confirm: "Вы уверены?", turbo_confirm: "Вы точно уверены?" }, method: :delete %></div>

  <div align="center">
    <%= link_to "Назад", :back, class: "back_button" %>
  </div>
    

  <script src="https://kit.fontawesome.com/c6ba37b0b2.js" crossorigin="anonymous"></script>

</body>
</html>


