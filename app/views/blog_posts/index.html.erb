<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
</head>
<body>

    <header class="header">
        <div class="header-top">
            <%= link_to "ФОТО БЛОГ", root_path, class: "logo" %>

            <nav class="navigation">
                <ul class="menu">
                    <li class="menu-element">
                        <%= link_to "Главная", root_path %>
                    </li>

                    <li class="menu-element">
                        <%= link_to "Добавить пост", "/blog_posts/new" %>
                    </li>

                    <li class="menu-element">
                        <% if user_signed_in? %>
                            <%= link_to "Мой профиль", user_path(current_user) %>
                        <% end %>
                    </li>

                    <li class="menu-element">
                        <% if user_signed_in? %>
                            <% if current_user.avatar.attached? %>
                                <img style="width: 50px; height: 50px; border-radius: 100px;" <%= image_tag url_for(current_user.avatar) %>
                            <% else %>
                                <%= image_tag "base-avatar.jpg", style: "width: 50px; height: 50px; border-radius: 100px;" %>
                            <% end %>
                        <% end %>
                    </li>

                    <% if !user_signed_in? %>
                        <li class="menu-element">
                            <%= link_to "Войти", new_user_session_path %>
                        </li>

                        <li class="menu-element">
                            <%= link_to "Регистрация", new_user_registration_path %>
                        </li>
                    <% end %>

                    
                    <%= form_tag root_path, method: :get do %>
                        <%= text_field_tag :search, params[:search], placeholder: "Найти пост", class: "search_field" %>
                        <%= submit_tag "Поиск", class: "search_button" %>
                    <% end %>
                    </li>
                </ul>
            </nav>

            
            
        </div>
    </header>

    <section>
        <div align="center">
            <h1 class="blog_title">ЛЕНТА ПОСТОВ</h1>
        </div>
    </section>

    
    

    <section>
        <div class="container">
            <div class="wrapper">
                <% if @no_results %>
                    <h3 class="no_result_search">Посты не найдены</h3>
                <% else %>
                    <% @blog_posts.each do |blog_post| %>
                        <div align="center" class="wrapper_post">
                            
                            <% if blog_post.user.avatar.attached? %>
                                <img class="user_avatar" <%= image_tag url_for(blog_post.user.avatar) %>
                            <% end %>

                            <% if @search_term.present? %>
                                <h2>
                                <%= highlight(blog_post.title, @search_term, highlighter: '<span class="highlight">\1</span>') %>
                                </h2>
                            <% else %>
                                <h2><%= blog_post.title %></h2>
                            <% end %>
                            
                            <!--<h2 class="blog_post_title"> <%= blog_post.title%> </h2>-->

                            <hr>
                            <img style="width: 500px; height: 500px; border-radius: 12px;" <%= image_tag blog_post.image %>
                            <h4>Дата публикации: <%= blog_post.created_at %> <br> </h4>
                            <%= link_to "Читать", blog_post, class: "index_link_to_post" %>
                        </div>
                        <br>
                    <% end %>
                <% end %>
                
            </div>
        </div>
    </section>
    
</body>
</html>